function T(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(e){return typeof e}:T=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(n)}var $=(typeof HTMLElement>"u"?"undefined":T(HTMLElement))==="object";function D(n){return $?n instanceof HTMLElement:n&&T(n)==="object"&&n!==null&&n.nodeType===1&&typeof n.nodeName=="string"}function B(n,t){t.forEach(function(e){n.classList.add(e)})}function p(n,t){t.forEach(function(e){n.classList.remove(e)})}var M=".drift-bounding-box,.drift-zoom-pane{position:absolute;pointer-events:none}@keyframes noop{0%{zoom:1}}@-webkit-keyframes noop{0%{zoom:1}}.drift-zoom-pane.drift-open{display:block}.drift-zoom-pane.drift-closing,.drift-zoom-pane.drift-opening{animation:noop 1ms;-webkit-animation:noop 1ms}.drift-zoom-pane{overflow:hidden;width:100%;height:100%;top:0;left:0}.drift-zoom-pane-loader{display:none}.drift-zoom-pane img{position:absolute;display:block;max-width:none;max-height:none}";function W(){if(!document.querySelector(".drift-base-styles")){var n=document.createElement("style");n.type="text/css",n.classList.add("drift-base-styles"),n.appendChild(document.createTextNode(M));var t=document.head;t.insertBefore(n,t.firstChild)}}function r(){throw new Error("Missing parameter")}function X(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function I(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Y(n,t,e){return t&&I(n.prototype,t),e&&I(n,e),n}var N=function(){function n(t){X(this,n),this.isShowing=!1;var e=t.namespace,i=e===void 0?null:e,s=t.zoomFactor,l=s===void 0?r():s,h=t.containerEl,o=h===void 0?r():h;this.settings={namespace:i,zoomFactor:l,containerEl:o},this.openClasses=this._buildClasses("open"),this._buildElement()}return Y(n,[{key:"_buildClasses",value:function(e){var i=["drift-".concat(e)],s=this.settings.namespace;return s&&i.push("".concat(s,"-").concat(e)),i}},{key:"_buildElement",value:function(){this.el=document.createElement("div"),B(this.el,this._buildClasses("bounding-box"))}},{key:"show",value:function(e,i){this.isShowing=!0,this.settings.containerEl.appendChild(this.el);var s=this.el.style;s.width="".concat(Math.round(e/this.settings.zoomFactor),"px"),s.height="".concat(Math.round(i/this.settings.zoomFactor),"px"),B(this.el,this.openClasses)}},{key:"hide",value:function(){this.isShowing&&this.settings.containerEl.removeChild(this.el),this.isShowing=!1,p(this.el,this.openClasses)}},{key:"setPosition",value:function(e,i,s){var l=window.pageXOffset,h=window.pageYOffset,o=s.left+e*s.width-this.el.clientWidth/2+l,a=s.top+i*s.height-this.el.clientHeight/2+h;o<s.left+l?o=s.left+l:o+this.el.clientWidth>s.left+s.width+l&&(o=s.left+s.width-this.el.clientWidth+l),a<s.top+h?a=s.top+h:a+this.el.clientHeight>s.top+s.height+h&&(a=s.top+s.height-this.el.clientHeight+h),this.el.style.left="".concat(o,"px"),this.el.style.top="".concat(a,"px")}}]),n}();function Z(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function O(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function U(n,t,e){return t&&O(n.prototype,t),e&&O(n,e),n}var j=function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Z(this,n),this._show=this._show.bind(this),this._hide=this._hide.bind(this),this._handleEntry=this._handleEntry.bind(this),this._handleMovement=this._handleMovement.bind(this);var e=t.el,i=e===void 0?r():e,s=t.zoomPane,l=s===void 0?r():s,h=t.sourceAttribute,o=h===void 0?r():h,a=t.handleTouch,g=a===void 0?r():a,c=t.onShow,f=c===void 0?null:c,y=t.onHide,u=y===void 0?null:y,d=t.hoverDelay,m=d===void 0?0:d,v=t.touchDelay,b=v===void 0?0:v,w=t.hoverBoundingBox,E=w===void 0?r():w,C=t.touchBoundingBox,L=C===void 0?r():C,A=t.namespace,k=A===void 0?null:A,z=t.zoomFactor,x=z===void 0?r():z,S=t.boundingBoxContainer,P=S===void 0?r():S;this.settings={el:i,zoomPane:l,sourceAttribute:o,handleTouch:g,onShow:f,onHide:u,hoverDelay:m,touchDelay:b,hoverBoundingBox:E,touchBoundingBox:L,namespace:k,zoomFactor:x,boundingBoxContainer:P},(this.settings.hoverBoundingBox||this.settings.touchBoundingBox)&&(this.boundingBox=new N({namespace:this.settings.namespace,zoomFactor:this.settings.zoomFactor,containerEl:this.settings.boundingBoxContainer})),this.enabled=!0,this._bindEvents()}return U(n,[{key:"_preventDefault",value:function(e){e.preventDefault()}},{key:"_preventDefaultAllowTouchScroll",value:function(e){(!this.settings.touchDelay||!this._isTouchEvent(e)||this.isShowing)&&e.preventDefault()}},{key:"_isTouchEvent",value:function(e){return!!e.touches}},{key:"_bindEvents",value:function(){this.settings.el.addEventListener("mouseenter",this._handleEntry,!1),this.settings.el.addEventListener("mouseleave",this._hide,!1),this.settings.el.addEventListener("mousemove",this._handleMovement,!1),this.settings.handleTouch?(this.settings.el.addEventListener("touchstart",this._handleEntry,!1),this.settings.el.addEventListener("touchend",this._hide,!1),this.settings.el.addEventListener("touchmove",this._handleMovement,!1)):(this.settings.el.addEventListener("touchstart",this._preventDefault,!1),this.settings.el.addEventListener("touchend",this._preventDefault,!1),this.settings.el.addEventListener("touchmove",this._preventDefault,!1))}},{key:"_unbindEvents",value:function(){this.settings.el.removeEventListener("mouseenter",this._handleEntry,!1),this.settings.el.removeEventListener("mouseleave",this._hide,!1),this.settings.el.removeEventListener("mousemove",this._handleMovement,!1),this.settings.handleTouch?(this.settings.el.removeEventListener("touchstart",this._handleEntry,!1),this.settings.el.removeEventListener("touchend",this._hide,!1),this.settings.el.removeEventListener("touchmove",this._handleMovement,!1)):(this.settings.el.removeEventListener("touchstart",this._preventDefault,!1),this.settings.el.removeEventListener("touchend",this._preventDefault,!1),this.settings.el.removeEventListener("touchmove",this._preventDefault,!1))}},{key:"_handleEntry",value:function(e){this._preventDefaultAllowTouchScroll(e),this._lastMovement=e,e.type=="mouseenter"&&this.settings.hoverDelay?this.entryTimeout=setTimeout(this._show,this.settings.hoverDelay):this.settings.touchDelay?this.entryTimeout=setTimeout(this._show,this.settings.touchDelay):this._show()}},{key:"_show",value:function(){if(!!this.enabled){var e=this.settings.onShow;if(e&&typeof e=="function"&&e(),this.settings.zoomPane.show(this.settings.el.getAttribute(this.settings.sourceAttribute),this.settings.el.clientWidth,this.settings.el.clientHeight),this._lastMovement){var i=this._lastMovement.touches;(i&&this.settings.touchBoundingBox||!i&&this.settings.hoverBoundingBox)&&this.boundingBox.show(this.settings.zoomPane.el.clientWidth,this.settings.zoomPane.el.clientHeight)}this._handleMovement()}}},{key:"_hide",value:function(e){e&&this._preventDefaultAllowTouchScroll(e),this._lastMovement=null,this.entryTimeout&&clearTimeout(this.entryTimeout),this.boundingBox&&this.boundingBox.hide();var i=this.settings.onHide;i&&typeof i=="function"&&i(),this.settings.zoomPane.hide()}},{key:"_handleMovement",value:function(e){if(e)this._preventDefaultAllowTouchScroll(e),this._lastMovement=e;else if(this._lastMovement)e=this._lastMovement;else return;var i,s;if(e.touches){var l=e.touches[0];i=l.clientX,s=l.clientY}else i=e.clientX,s=e.clientY;var h=this.settings.el,o=h.getBoundingClientRect(),a=i-o.left,g=s-o.top,c=a/this.settings.el.clientWidth,f=g/this.settings.el.clientHeight;this.boundingBox&&this.boundingBox.setPosition(c,f,o),this.settings.zoomPane.setPosition(c,f,o)}},{key:"isShowing",get:function(){return this.settings.zoomPane.isShowing}}]),n}();function q(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function H(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function V(n,t,e){return t&&H(n.prototype,t),e&&H(n,e),n}var G=function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(q(this,n),this.HAS_ANIMATION=!1,typeof document<"u"){var e=document.createElement("div").style;this.HAS_ANIMATION="animation"in e||"webkitAnimation"in e}this._completeShow=this._completeShow.bind(this),this._completeHide=this._completeHide.bind(this),this._handleLoad=this._handleLoad.bind(this),this.isShowing=!1;var i=t.container,s=i===void 0?null:i,l=t.zoomFactor,h=l===void 0?r():l,o=t.inline,a=o===void 0?r():o,g=t.namespace,c=g===void 0?null:g,f=t.showWhitespaceAtEdges,y=f===void 0?r():f,u=t.containInline,d=u===void 0?r():u,m=t.inlineOffsetX,v=m===void 0?0:m,b=t.inlineOffsetY,w=b===void 0?0:b,E=t.inlineContainer,C=E===void 0?document.body:E;this.settings={container:s,zoomFactor:h,inline:a,namespace:c,showWhitespaceAtEdges:y,containInline:d,inlineOffsetX:v,inlineOffsetY:w,inlineContainer:C},this.openClasses=this._buildClasses("open"),this.openingClasses=this._buildClasses("opening"),this.closingClasses=this._buildClasses("closing"),this.inlineClasses=this._buildClasses("inline"),this.loadingClasses=this._buildClasses("loading"),this._buildElement()}return V(n,[{key:"_buildClasses",value:function(e){var i=["drift-".concat(e)],s=this.settings.namespace;return s&&i.push("".concat(s,"-").concat(e)),i}},{key:"_buildElement",value:function(){this.el=document.createElement("div"),B(this.el,this._buildClasses("zoom-pane"));var e=document.createElement("div");B(e,this._buildClasses("zoom-pane-loader")),this.el.appendChild(e),this.imgEl=document.createElement("img"),this.el.appendChild(this.imgEl)}},{key:"_setImageURL",value:function(e){this.imgEl.setAttribute("src",e)}},{key:"_setImageSize",value:function(e,i){this.imgEl.style.width="".concat(e*this.settings.zoomFactor,"px"),this.imgEl.style.height="".concat(i*this.settings.zoomFactor,"px")}},{key:"setPosition",value:function(e,i,s){var l=this.imgEl.offsetWidth,h=this.imgEl.offsetHeight,o=this.el.offsetWidth,a=this.el.offsetHeight,g=o/2,c=a/2,f=l*e,y=h*i,u=g-f,d=c-y,m=o-l,v=a-h,b=m>0,w=v>0,E=b?m/2:0,C=w?v/2:0,L=b?m/2:m,A=w?v/2:v;if(this.el.parentElement===this.settings.inlineContainer){var k=window.pageXOffset,z=window.pageYOffset,x=s.left+e*s.width-o/2+this.settings.inlineOffsetX+k,S=s.top+i*s.height-a/2+this.settings.inlineOffsetY+z;this.settings.containInline&&(x<s.left+k?x=s.left+k:x+o>s.left+s.width+k&&(x=s.left+s.width-o+k),S<s.top+z?S=s.top+z:S+a>s.top+s.height+z&&(S=s.top+s.height-a+z)),this.el.style.left="".concat(x,"px"),this.el.style.top="".concat(S,"px")}this.settings.showWhitespaceAtEdges||(u>E?u=E:u<L&&(u=L),d>C?d=C:d<A&&(d=A)),this.imgEl.style.transform="translate(".concat(u,"px, ").concat(d,"px)"),this.imgEl.style.webkitTransform="translate(".concat(u,"px, ").concat(d,"px)")}},{key:"_removeListenersAndResetClasses",value:function(){this.el.removeEventListener("animationend",this._completeShow,!1),this.el.removeEventListener("animationend",this._completeHide,!1),this.el.removeEventListener("webkitAnimationEnd",this._completeShow,!1),this.el.removeEventListener("webkitAnimationEnd",this._completeHide,!1),p(this.el,this.openClasses),p(this.el,this.closingClasses)}},{key:"show",value:function(e,i,s){this._removeListenersAndResetClasses(),this.isShowing=!0,B(this.el,this.openClasses),this.imgEl.getAttribute("src")!=e&&(B(this.el,this.loadingClasses),this.imgEl.addEventListener("load",this._handleLoad,!1),this._setImageURL(e)),this._setImageSize(i,s),this._isInline?this._showInline():this._showInContainer(),this.HAS_ANIMATION&&(this.el.addEventListener("animationend",this._completeShow,!1),this.el.addEventListener("webkitAnimationEnd",this._completeShow,!1),B(this.el,this.openingClasses))}},{key:"_showInline",value:function(){this.settings.inlineContainer.appendChild(this.el),B(this.el,this.inlineClasses)}},{key:"_showInContainer",value:function(){this.settings.container.appendChild(this.el)}},{key:"hide",value:function(){this._removeListenersAndResetClasses(),this.isShowing=!1,this.HAS_ANIMATION?(this.el.addEventListener("animationend",this._completeHide,!1),this.el.addEventListener("webkitAnimationEnd",this._completeHide,!1),B(this.el,this.closingClasses)):(p(this.el,this.openClasses),p(this.el,this.inlineClasses))}},{key:"_completeShow",value:function(){this.el.removeEventListener("animationend",this._completeShow,!1),this.el.removeEventListener("webkitAnimationEnd",this._completeShow,!1),p(this.el,this.openingClasses)}},{key:"_completeHide",value:function(){this.el.removeEventListener("animationend",this._completeHide,!1),this.el.removeEventListener("webkitAnimationEnd",this._completeHide,!1),p(this.el,this.openClasses),p(this.el,this.closingClasses),p(this.el,this.inlineClasses),this.el.style.left="",this.el.style.top="",this.el.parentElement===this.settings.container?this.settings.container.removeChild(this.el):this.el.parentElement===this.settings.inlineContainer&&this.settings.inlineContainer.removeChild(this.el)}},{key:"_handleLoad",value:function(){this.imgEl.removeEventListener("load",this._handleLoad,!1),p(this.el,this.loadingClasses)}},{key:"_isInline",get:function(){var e=this.settings.inline;return e===!0||typeof e=="number"&&window.innerWidth<=e}}]),n}();function J(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function F(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function K(n,t,e){return t&&F(n.prototype,t),e&&F(n,e),n}var _=function(){function n(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(J(this,n),this.VERSION="1.4.4",this.triggerEl=t,this.destroy=this.destroy.bind(this),!D(this.triggerEl))throw new TypeError("`new Drift` requires a DOM element as its first argument.");var i=e.namespace||null,s=e.showWhitespaceAtEdges||!1,l=e.containInline||!1,h=e.inlineOffsetX||0,o=e.inlineOffsetY||0,a=e.inlineContainer||document.body,g=e.sourceAttribute||"data-zoom",c=e.zoomFactor||3,f=e.paneContainer===void 0?document.body:e.paneContainer,y=e.inlinePane||375,u="handleTouch"in e?!!e.handleTouch:!0,d=e.onShow||null,m=e.onHide||null,v="injectBaseStyles"in e?!!e.injectBaseStyles:!0,b=e.hoverDelay||0,w=e.touchDelay||0,E=e.hoverBoundingBox||!1,C=e.touchBoundingBox||!1,L=e.boundingBoxContainer||document.body;if(y!==!0&&!D(f))throw new TypeError("`paneContainer` must be a DOM element when `inlinePane !== true`");if(!D(a))throw new TypeError("`inlineContainer` must be a DOM element");this.settings={namespace:i,showWhitespaceAtEdges:s,containInline:l,inlineOffsetX:h,inlineOffsetY:o,inlineContainer:a,sourceAttribute:g,zoomFactor:c,paneContainer:f,inlinePane:y,handleTouch:u,onShow:d,onHide:m,injectBaseStyles:v,hoverDelay:b,touchDelay:w,hoverBoundingBox:E,touchBoundingBox:C,boundingBoxContainer:L},this.settings.injectBaseStyles&&W(),this._buildZoomPane(),this._buildTrigger()}return K(n,[{key:"_buildZoomPane",value:function(){this.zoomPane=new G({container:this.settings.paneContainer,zoomFactor:this.settings.zoomFactor,showWhitespaceAtEdges:this.settings.showWhitespaceAtEdges,containInline:this.settings.containInline,inline:this.settings.inlinePane,namespace:this.settings.namespace,inlineOffsetX:this.settings.inlineOffsetX,inlineOffsetY:this.settings.inlineOffsetY,inlineContainer:this.settings.inlineContainer})}},{key:"_buildTrigger",value:function(){this.trigger=new j({el:this.triggerEl,zoomPane:this.zoomPane,handleTouch:this.settings.handleTouch,onShow:this.settings.onShow,onHide:this.settings.onHide,sourceAttribute:this.settings.sourceAttribute,hoverDelay:this.settings.hoverDelay,touchDelay:this.settings.touchDelay,hoverBoundingBox:this.settings.hoverBoundingBox,touchBoundingBox:this.settings.touchBoundingBox,namespace:this.settings.namespace,zoomFactor:this.settings.zoomFactor,boundingBoxContainer:this.settings.boundingBoxContainer})}},{key:"setZoomImageURL",value:function(e){this.zoomPane._setImageURL(e)}},{key:"disable",value:function(){this.trigger.enabled=!1}},{key:"enable",value:function(){this.trigger.enabled=!0}},{key:"destroy",value:function(){this.trigger._hide(),this.trigger._unbindEvents()}},{key:"isShowing",get:function(){return this.zoomPane.isShowing}},{key:"zoomFactor",get:function(){return this.settings.zoomFactor},set:function(e){this.settings.zoomFactor=e,this.zoomPane.settings.zoomFactor=e,this.trigger.settings.zoomFactor=e,this.boundingBox.settings.zoomFactor=e}}]),n}();Object.defineProperty(_.prototype,"isShowing",{get:function(){return this.isShowing}});Object.defineProperty(_.prototype,"zoomFactor",{get:function(){return this.zoomFactor},set:function(t){this.zoomFactor=t}});_.prototype.setZoomImageURL=_.prototype.setZoomImageURL;_.prototype.disable=_.prototype.disable;_.prototype.enable=_.prototype.enable;_.prototype.destroy=_.prototype.destroy;export{_ as D};
